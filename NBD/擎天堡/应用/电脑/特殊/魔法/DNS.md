‍

暂时不要尝试这种危险不稳定的玩意罢

‍

‍

## 选型

‍

[知乎问题链接](https://www.zhihu.com/question/32229915)

[链接2](https://www.zhihu.com/question/393321165)

‍

> 我本来搜这个问题也就只是想看看有没有哪家比较快的，看了一遍好像也没什么太大差距
>
> 对于绝大多数普通用户讲太多都是花里胡哨，简单一点就把各个公共DNS服务器地址都ping一遍，看看TTL和响应速度，哪个快就用哪

‍

‍

* 装个1.1.1.1，然后加入零信任网络，所有流量（包括DNS流量）都走Cloudflare的网关. 

  这样无论是dns污染、gfw的重放攻击，还是深度包检测带来的问题都解决了.
* 注意，修改DNS并不能提升网速，文件下载速度，该是多少还是多少. 

  DNS优化网络的意义在于，加快IP解析速度，从而提高网页打开速度. 

  **修改DNS的好处：**

  1. 适当提高上网速度；
  2. 更换DNS可以访问某些因为[域名解析](https://www.zhihu.com/search?q=%E5%9F%9F%E5%90%8D%E8%A7%A3%E6%9E%90&search_source=Entity&hybrid_search_source=Entity&hybrid_search_extra=%7B%22sourceType%22%3A%22article%22%2C%22sourceId%22%3A%22104285769%22%7D)存在问题而不能访问的网站；
  3. 可以屏蔽运营商的广告，还可以帮助您避免被钓鱼的危险；

  从解决实际问题的角度上，这里给大家推荐一款DNS修改的软件【**DNS Jumper**】，这个小工具有三大亮点功能：

  1、根据当前连接网络，测试寻找最适合你，速度最快的DNS. 

  2、测试DNS速度

  3、Windows修改DNS的界面非常隐蔽，点进去很麻烦，这款软件简化DNS修改步骤. 

  Dns Jumper 是一款绿色软件，点击exe直接运行，无需安装，大小仅仅885kb. 

  [链接](https://www.zhihu.com/question/393321165/answer/3117315352)
* 127.0.0.1最快了(本地缓存, 废话!)
* [链接](https://www.zhihu.com/question/393321165/answer/2842090164)

  我建议有点技术经验的人是：全都要

  这里先说大多数人能做的

  一般人就主配运营商的dns，就是自动获取就行了，再任意配个其它dns就行了

  或者再看自己需求

  上淘宝多，主dns就配阿里的223.5.5.5

  看腾讯视频，玩王者荣耀这种腾讯系的游戏就配腾讯的dns119.29.29.29

  爱逛贴吧就配百度的180.76.76.76

  爱逛各种技术小博客，就配cloudflare的1.1.1.1

  然后最多我们在浏览器里装一个广告屏蔽器，不去拿额外的东西，这样也可以减少打开网页的时间，比如adp，adguard之类的

  我给你说下dns和网速的关联在哪里

  dns只是帮你找到通讯的对方电脑的位置，说实际一点是猜对方位置，通过对方在一个长长的地址记录本里，把它电脑的名字和他的位置在dns登记在册，你去dns取这个位置，然后尝试和对方通信

  你上网就是和对方电脑通信，你从它那拿东西，你也拿东西给它

  那么dns起的作用是把名字转化成对方电脑的位置

  你输入的网址就是对方电脑的名字，以及对方电脑上东西的名字

  那你想都不用想，肯定离你最近的电脑你能最快拿到东西吧？

  但是也要看路，你去这个电脑的路九里十八弯，你开个车也不可能加速，而另一个稍微远点，但是是高速，肯定就是去稍远的高速来回用时短了

  再看你要拿的东西多不多，比如你把东西丢河里走水运，而一条是流速快的小河道，一条是流速相对缓慢的大河道，小河道水流快东西走得快些，但是河道窄，一次丢不了太多东西，所以东西多肯定走大河道,理想情况下是多个河道一起用，有的河道还有障碍，很可能你的东西就卡在河道某个位置很久出不来

  等我们消息到了对方以后，对方又会把东西按照它的理解给我们走另外的水路运回来，那对方在处理这些消息的时候又会有延迟，你想想你去排队的时候就是这种情况，好在它现在知道我们电脑的位置了，不需要再去猜我们在哪里，

  所以我们期望dns能让我们网速快，最理想情况下就是帮我们找到存有我们想要资源的距离最近，河道最宽最直的那个位置，然后我们去取

  但是dns真能管这么多吗？

  想要最近，那dns需要知道你的位置，然后帮你找个最近的

  想要最宽，这个从原理上dns无从得知

  想要最直，一般而言，距离近的就是最直的，但是这在某些地方有特例，不过你就认为距离近的就最直在很多情况下没有问题

  最后有一点，就是很多时候我们不需要去拿一些东西，但是对方电脑会告诉你我还有些大宝贝给你看，等你千辛万苦跑个来回，发现是一大堆垃圾广告

  实际生活中我们还在不同河道运营商的线路上丢木头，不同运营商的河道有交接的地方，这个地方一般不是特别宽，所以大家的木头就等着排队

  这里也是影响你木头的运输速度的

  这个地方dns或许能帮你，如果对方登记过多个地址，理想情况下dns会给我们相同运营商的地址

  所以我们能从dns上对网速做出改变的，距离近的一般响应速度越快，但是河道有多宽并不能保证，河道宽度就是dns无法解决的问题了，这个有两个办法尝试去提升，但是最终决定还是在对方位置最后一段河道的宽度

  所以我们能做的有以下几点

  1. 多找几个dns，告诉它们我自己的位置，然后都问一遍对方存东西的位置，我们会得到较多的位置
  2. 对这些位置进行测试，我们要是去测线路直不直就消耗太多时间了，测河道宽度也消耗时间，而且河道拥挤程度还要取决于河道里木头多不多，所以我们能做的只有看看到哪个位置用时最短，不管它距离远近，河道宽度了
  3. 找到往返用时最短的，然后且就和它通讯吧，现在的技术情况下确实不能达到一个理想情况，我们不能在较短的时间内获知对方存东西的地方的很多信息
  4. 对于一些自己探测过的或者非常熟悉的位置，可以自己做优化，取这些位置东西的时候就直接去取，不用再问dns这些东西的位置，这就省去了询问的时间，也免去了不小心找个很难到的地方的问题.

  好了，所有分析我们大致都过了一遍，技术上我们要做的可能很多人都做不到，所以一般人你就随便配dns吧，一般运营商的优先，阿里腾讯114cloudflare之类的也可以

  说一下cloudflare，因为它自己在提供cdn暂存服务，就是它帮对方电脑把一些东西分散在全球各地仓库，有点像京东就近发货，哪离你近它就让你去它那拿，这样也实现了把同一批东西拆到不同地点的需求，免得有些恶霸在某一条路上拦路抢劫，你那一批东西就一直取不到的情况

  所以设置cloudflare的1.1.1.1也是有这个好处的

  不过其他dns也有这个功能的，比如你爱看腾讯视频，那腾讯的dns也会告诉你，你想看的电影最近的位置

  所以我们怎么办呢，windows上默认是并发查询的，windows最多可以指定哪些域名走哪个dns，

‍

‍

收集网友在知乎的看法

* 只能说

  国内的DNS都被污染透彻了（包括公共DNS），但基本你能访问的国外DNS都被过滤过，不能访问的被BAN的，你也没办法用

  骨干路由会在你敲下域名的时候就给你来个DNS重置和证书乱指让你无法打开网页或者指向有广告的网页跳转，IP被大范围封禁的，比如谷歌什么的，就别想了，如果你想用VXN的形式，那么我可以告诉你，最多给你玩一个星期左右就没了（非运营商那种）

  对于小白来说彻底是很难的，最多屏蔽掉一些广告的域名就是了
* DNS污染的主要来源：

  * 不可靠的DNS服务器
  * DNS查询劫持

  对于DNS服务器，避免使用ISP自动分配的DNS服务器/已知存在污染的服务器，手动指定安全的公共DNS服务器（如果可以访问），或者自己假设私有DNS服务器. 

  对于DNS查询劫持，国内某些运营商的地方公司喜欢用这种方式实现强行植入广告，主要通过DNSSEC或是DOH（[DNS over HTTPS](https://zh.wikipedia.org/zh-tw/DNS_over_HTTPS)）避免被劫持. 

  另外利用好本地host记录也可以避免对特定域名的影响，代价是可能会影响CDN性能
*  

  * 直接访问国外dns服务器（怎么访问别问我，这不属于“如何解决dns污染”这个问题）
  * 使用自己的dns服务，编辑本地hosts文件是最简单的途径

    * 不行的DNS解析请求是明文，返回结果已经被污染了

      * 用隧道啊, 套层“数据删除”不就能访问了吗
* 没有很好的办法，劫持总是会有的，只要使用别人的东西，你这里不劫持，上层还是会劫持. 推荐自己搭建的DNS服务，或者smartDNS，可github搜索，自己搭建内部大型DNS服务器也行. 开启DoH或者DoT，详情请看：

  [  ](https://zhuanlan.zhihu.com/p/589043772)
* DNS劫持的原理是： 普通DNS协议数据包本身不加密也没有防伪，完全可以侦听你的请求知道你尝试解析什么，也可以随意伪造一个假的回复.  客户端没法验证回复的真伪，只能先来后到，先收到什么回复就算什么回复.  那么解决方案很明显了，加密发送与回复，让劫持方无法侦听分析，也无法伪造出合法回复.  那么就无法劫持了，只能采用彻底封堵的笨办法.
* 对于**DNS污染**，一般除了使用代理服务器和VPN之类的软件之外，并没有什么其它办法. 但是利用我们对[DNS污染](https://www.zhihu.com/search?type=content&q=DNS%E6%B1%A1%E6%9F%93)的了解，还是可以做到不用代理服务器和VPN之类的软件就能解决**DNS污染**的问题，从而在不使用代理服务器或VPN的情况下访问原本访问不了的一些网站. 

  当然这无法解决所有问题，当一些无法访问的网站本身并不是由[DNS污染](https://www.zhihu.com/search?type=content&q=DNS%E6%B1%A1%E6%9F%93)问题导致的时候，还是需要使用代理服务器或VPN才能访问的. 

  DNS污染的数据包并不是在网络数据包经过的路由器上，而是在其旁路产生的. 所以**DNS污染**并无法阻止正确的[DNS解析](https://www.dns.com/high_defense_dns.html)结果返回，但由于旁路产生的数据包发回的速度较国外DNS服务器发回的快，操作系统认为第一个收到的数据包就是返回结果，从而忽略其后收到的数据包，从而使得DNS污染得逞. 

  而某些国家的DNS污染在一段时期内的污染IP却是固定不变的，从而可以忽略返回结果是这些IP地址的数据包，直接解决DNS污染的问题. 

  我们在命令行下通过这样一条命令：

  nslookup 域名 144.223.234.234，即可判断该域名是否被污染，由于144.223.234.234不存在，理应没有任何返回. 但我们却得到了一个错误的IP（不确定）. 即可证明这个域名已经被DNS污染了. 

  ‍

  1、使用各种SSH加密代理，在加密代理里进行远程DNS解析，或者使用VPN上网. 

  2、修改hosts文件，操作系统中Hosts文件的权限优先级高于DNS服务器，操作系统在访问某个域名时，会先检测HOSTS文件，然后再查询DNS服务器. 可以在hosts添加受到污染的DNS地址来解决D[NS污染和DNS劫持. ](https://www.dns.com/speed.html)

  3、通过一些软件编程处理，可以直接忽略返回结果是虚假IP地址的数据包，直接解决DNS污染的问题. 

  4、如果你是Firefox only用户，并且只用Firefox，又懒得折腾，直接打开Firefox的远程DNS解析就行了. 在地址栏中输入：

  about:config

  找到network.proxy.socks_remote_dns一项改成true. 

  5、使用DNSCrypt软件，此软件与使用的OpenDNS直接建立相对安全的TCP连接并加密请求数据，从而不会被污染.
* 1，dns污染要么是你的服务器dns被人改了，要么是dns服务端被改了，前两种好解决，换个dns服务器就行了

  2，还有种骚操作就是国内污染了，国外没污染，不管你怎么换dns都没用，你品你细细品. 

  3，基本上用大厂的dns基本上没啥问题，谷歌，cloudflare，aws，等等，除非是我说的第二点，这层人都惹不起，老老实实慢慢测试，不是dns就是域名问题.
* 我采用的方案是 dnsmasq+dnscrypt-proxy，dnsmasq做缓存，dnscrypt-proxy从加密dns获取解析. 

  加密dns基本上基于四种协议，dnscrypt，dns over tls, dns over https, dns over quic. 其中较常用的是dns over tls 和 dns over https，而DoT使用853端口很容易被定向封锁，事实上国内基本上都是完全封禁853端口的，所以能够使用的只有采用443端口，和正常https无法区分的DoH. （dnscrypt也还算常用，也可以用）. 所以需要选取一个支持DoH的dns客户端. dnscrypt-proxy可以满足这个需求. 它的配置文件里自带了许多加密dns的列表，会自动选取最快的，并且有分组，可以自己配置成只在无审查dns里面选用. 即便如此，dns解析依然偏慢，不够稳定，所以需要dnsmasq做一下缓存. 

  我用smartdns配合google的dns连接很快啊，853端口，而且解析结果是正确的. 

  * 可能你那里没封吧; 是的，我也曾经折腾了很久，才发现是端口被封了
* 用加密dns. 

  安卓手机端叫私人dns，华为好像是另一个新词，苹果手机有没有这个功能我不知道. 

  电脑Edge浏览器和Chrome浏览器中，这个功能叫安全dns. 

  注意，一定要用国外能连接上的服务器. 国外有些连接不上. 而如果用国内的，还是分分钟给你污染了. 

  * 四个1应该是可以的.  (国外)

‍
