--Vive la SiYuan

‍

‍

‍

### Header

‍

当前是NBD工作空间(主空间)

联动笔记系统, 构建我们的外置大脑

[历史版本下载页面](https://github.com/siyuan-note/siyuan/releases)

‍

‍

‍

## 格式规范

‍

### Tips

‍

* 在正在施工的文档下的子文档一字排开等待后期合并

  合并文件目录时, 在未合并之前请使用文件链, 不破坏状态

  通过删除文章标题来快速标记要删除抛弃的文章
* 可以创建TLB来针对信息量冗余的操作性笔记本进行快速方法提炼, 设置为子文档

  网课学习只要记录精简的已经保存的代码, 无需写环境, 到时候查即可(本地有项目备份)
* 模拟缓存策略调入知识仓库, 无用笔记选择关闭, 后期使用备用工作空间收纳
* 仿照C语言虚类设计, 前三级笔记本都可以只设计Header来统领下面的笔记本集合而不记录任何信息
* 经常使用的文档不需要加题头图, 方便快速查看. 一般重要文档需要添加
* 基础的KV格式数据管理可以采用 K加粗, 换行顶格直接写V的形式, 只需要处理一次加粗格式, 然后换个行就能让展示效果美观了

  不要使用所谓分号一行堆砌, 直接换行即可
* 中英文中的空格在标题等展示地方可加, 普通plain text我觉得不是很必要
* Bugfix(多处文档使用, 必须后面全小写), T'O'D'O(全局唯一标识符, 用来手动快速查找T'O'D'O, 平常引用需要使用这样的插入符号标识
* 持久化知识区间不要以思源折叠块来替代引述内容, 否则导致格式丢失
* 将面试题存储到实操里面, 放在Bugfix上面
* 在部分解释器上, Markdown中无效的Tab缩进会被删掉, 这个暂时在本地MD里面没事, 但是展示可能会有问题

‍

‍

‍

### 备用

‍

‍

* 备注内容皆为转换格式的==纯文本==, 不建议放入分段文字
* 花里胡哨的样式与链接少用; 尽量Plain text
* 配色要求: 二级标题为粉色,一级为蓝色.特种三级自定义
* 连续字段使用统一的块,否则不利于CV编辑
* 文档开头第一段可以为说明段或者是命名段
* 能不添加例如<kbd>: </kbd>​​​元素就不添加, 尽可能使用缩进, 增强简洁度
* 代码段记得清除样式<sup>（给我把要经常复制黏贴的代码的样式去掉啊! 不然复制时候都是**要死了）</sup>,并记得用==复制纯文本==​<kbd>CS+C</kbd>​​​
* 备注如果选定文字范围不合理需要连带之前备注范围一起框选扩大
* 减少吃性能的对象使用, e.g. 长文本, 大列表
* 经常复制的内容不要使用`这样的`​, 而是要代码段, 方便去除首尾的`符号复制
* 进行大量的文档转移和剪切黏贴时候记得看看右上角字数, 可能要删除前这个文档是有东西的! (上次就是这么死的)
* 一般新创建的标题是二级, 其上下都留下扩充空间
* 引用<kbd>---</kbd>​来完成对大纲无痛的信息段中分页 -- 分割不方便用标题分隔的内容

‍

‍

‍

‍

### SK文档树管理规范V1.5

一个父标签包含的子标签应当有限制: 核心内容为2-6条为妙; 可以让一些无关紧要的内容合并入父标题

‍

撇开集群不谈, 必须要保证核心内容, 例如Java, 在:

集群) -> 集团军 -> 师 -> 团 -> 营 级别内找到

‍

> 尽量在
>
> 集群)(基建集群) -> 集团军(语言) -> 师(直属) -> 团(Java) 这一个文档层级内找到
>
> ‍
>
> 例如
>
> 集群)(基建集群) ->1 集团军(语言) ->2 师(直属) ->3 团(Java) ->4 营(JVM) +5 附属 + 6保留
>
> 深度计算为核心3, 次核心4 ,附属5 附属保留6
>
> 恰好符合6级深度要求

‍

‍

‍

### SK语言学习模板V1.5

> ```java
>
> ## Header
>
>
> ### 速查
>
>
>
> ### 环境
>
>
>
> # 知识
>
>
>
> ## 底层
>
>
>
> ## 命名
>
>
>
> ## 工程
>
>
>
>
> # 基础
>
>
>
> ## 数型
>
>
>
> ## 基础语法
>
>
>
> ## 进阶语法
>
>
>
> ## 数学
>
>
>
> ## 方法
>
>
>
> ## OO
>
>
>
> ## 异常
>
>
>
> # 高级
>
>
> ## 数构
> ```

‍

‍

‍

‍

### CRUD操作管理规范V1.5

‍

#### 增

‍

#### 删

‍

#### 改

‍

#### 查

‍

‍

‍

‍

### 新内容学习管理规范V1.5

‍

--我要卷土重来

‍

#### 评价

‍

#### 注意

‍

#### 环境

‍

#### 资源

‍

##### 链接

‍

#### 其他

‍

‍

‍

‍

‍

‍

‍

## 功能序列

‍

‍

### 直属功能

‍

* 快速选择对应位置的标签页 <kbd>Ctrl + Num</kbd>​​​​​​​​​​​​​​​​​​​​
* 中键关闭页面(浏览器通用0)
* 用顿号的话，敲反斜杠 `\`​​​​​​​​​​​​​​​​​同时避免弹出菜单栏
* 替换    选中关键字按 <kbd>C+A+S + R</kbd>​​​​​​​​​​​​​​​
* 划词搜索    选中某字词搜索
* 关闭全部 <kbd>Ctrl + Alt + W</kbd>​​​​​​​​​​​​​​​​​
* 电脑文件资源管理器直接拖动到思源能够生成直接的链接
* 导出自己存档需要导出sy.zip 和 MD便于查看, 展示可以用HTML和PDF渲染原本效果
* 使用网络图片链接方式插入从网络记录的文件
* 使用分屏功能可以迅速的进行段落的转移等需要上下滚屏的操作
* ​<kbd>CtrlA</kbd>​​​​ + <kbd>CtrlQ</kbd>​​​​全部清除格式, 直接用<kbd>CtrlA + Q</kbd>​​​​快速清理
* ​<kbd>CtrlA</kbd>​​​​ + <kbd>Space</kbd>​​​​快速清理块(但是变成空格下次会影响) + <kbd>Enter / Backspace</kbd>​​​​(还好, 但是要双手)
* ​<kbd>Ctrl</kbd>​​​​ + <kbd>Alt</kbd>​​​​ + X 直接调用格式面板
* ​<kbd>Shift + ↑</kbd>​​​​ 选取行内从行首到光标处元素, 连续按动即可转移到选取块(静音)

  嵌套使用即可在列表项内选取
* 列表缩进调整快捷键切换左手单手 <kbd>Alt + Z / C</kbd>​​, TO'DO列表切换为 <kbd>Alt + |</kbd>​​
* 关闭其他文档 切换为 关闭全部文档位置 <kbd>C + A + W</kbd>​

​

‍

‍

### 备用功能

‍

调整层级顺序

* 关闭当前文档  <kbd>Alt+W</kbd>​​​
* 用 `Tab`​​​​​ 和 `Shift + Tab`​​​​​ 做左右移动（子母层级）
* 用 `Ctrl + Shift + ↑(↓)`​​​​​ 做上下移动（同层级）
* 最近打开|定位当前 <kbd>Alt+R</kbd>​​​ | <kbd>Alt+E</kbd>​​​
* 上下移动<sup>（这在复杂情境被证明很好用）</sup>选定块: <kbd>Ctrl+Shift</kbd>​​​ + <kbd>↑</kbd>​​​ | <kbd>↓</kbd>​​​
* 外置图片空间
* 左右滚动 <kbd>Shift+滚轮</kbd>​
* 增强搜索/全局搜索  <kbd>Ctrl+Shift+F</kbd>​ / <kbd>Ctrl+P</kbd>​ + 搜索替换
* 导出功能提取模板, 之后可在任何地方调用

‍

‍

‍

#### 插入图片或文件

制作流程图和图表(Javascript格式), 插入视频等资源链接

* ​<kbd>复制为资源文件并插入</kbd>​：将图片或文件复制为资源文件并插入，快捷键 <kbd>Ctrl+V</kbd>​
* ​<kbd>使用 file:// 绝对路径并链接</kbd>​：将图片或文件以本地绝对路径方式插入超链接，快捷键 <kbd>Ctrl+Shift+V</kbd>​，或者按住 <kbd>Alt</kbd>​ 后拖入

‍

使用HTML img链接完成图片添加(需要已知网页图片链接地址, 截图不能使用)

```java
<div>
<img src="https://seazean.oss-cn-beijing.aliyuncs.com/img/Java/JVM-JRE关系.png" style="zoom: 80%;" />
</div>
```

‍

‍

‍

‍

### 封存功能

‍

‍

功能快捷键

* 分割线  <kbd>---</kbd>​​
* 插入代码块<sup>（相当于IDEA里面运行的快捷键）</sup>  <kbd>alt+v</kbd>​​
* 换行<sup>（在列表项和段落中）</sup> <kbd>Shift Enter</kbd>​​
* 键盘标记<sup>（美观简洁展示快捷键）</sup>  <kbd>Ctrl+'</kbd>​​
* 控制缩进<sup>（而不是空格! 不好掌握个数而且费劲）</sup>  <kbd>Tab</kbd>​​
* 跳转刚才浏览位置<sup>（功能挺智障的,等优化吧）</sup>  <kbd>Ctrl+→ / ←</kbd>​​
* 备注<sup>（太方便了吧! 右键打开面板,Esc退出）</sup>  <kbd>Ctrl+Alt+Z</kbd>​​
* 一键唤醒/隐藏<sup>（能够驻留在后台,并且一键唤醒）</sup> <kbd>Alt+`</kbd>​​
* 折叠块 <kbd>Alt+Click_Button</kbd>​​
* 复制纯文本 <kbd>Ctrl+Shift+C</kbd>​​
* 回到开头/结尾 <kbd>Ctrl+Home/End</kbd>​​
* 无序列表有序列表<u>快速调用</u>: <kbd>数字+空格</kbd>​​ | <kbd>加号/减号</kbd>​​
* 标题符号中的  剪切下方块<sup>（搬家大法宝）</sup>; 连带子标题转换记得从上往下转<sup>（不然后面的被反复拷打）</sup>
* 插件  <kbd>/date/time</kbd>​​ 当前时间
* 需要插入行级代码的前后位置输入<kbd>`</kbd>​​ 即可
* 页签切换 <kbd>Ctrl+Tab</kbd>​​
* 书签<sup>（当成收藏夹用吧 ）</sup>  管理多个生产环境 <kbd>Alt+3</kbd>​​
* 上方任务栏管理<sup>（快速关闭无用文档,也可以用Alt+W）</sup> <kbd>倒三角</kbd>​​
* ​<kbd>Ctrl + /</kbd>​​ 手动触发块标
* 折叠无用内容块: <kbd>Alt+Click 标签</kbd>​​ / <kbd>Ctrl + ↑ 任何地方</kbd>​​
* 删除线 - 代替折叠 <kbd>Shift+Ctrl+S</kbd>​
* 清除格式<sup>（防止无效大写等样式影响Ctrl+C/V效率）</sup>  <kbd>Ctrl+Q</kbd>​
* 选择范围控制(连字/单字)<sup>(同时按住C+S来扩大缩小选区的时候就能体会到加速了 )</sup>  <kbd>Ctrl+Shift/Shift+ ←→</kbd>​

‍

‍

‍

‍

‍

‍

### 未来科技

‍

> 暂时停止

‍

‍

#### 强化同步

rclone 备份等主动备份资源文件功能

‍

#### 选择同步内容，类似.gitignore

[Link](https://ld246.com/article/1712577971585)

在用户指南笔记本搜索「忽略」

临时设置[忽略文件目录], 存放大批量文件

​![](https://b3logfile.com/file/2024/04/image-K5S6PJ7.png?imageView2/2/interlace/1/format/webp)​

已经确立了忽略文件夹, 可以进行导入操作.

‍

‍

#### 搜索资源文件

可以直接找图片进行处理, 其实没什么用

‍

#### 双链功能强化

‍

‍

##### 引用与嵌入块

‍

引用块

* 指的是你可以在当前文档页内附上其他文档页
* 最大好处是能用来做资料引用和对比，注意一点——改动引用块的内容**不会同步**到其他地方
* 两个输入方法：

  1. 键入两个方括号 `【【`​​​，然后回车选择对应引用块或新建文档
  2. 在想要的页面里，对着标题操作“复制该块为引用块”，然后回到本页面粘贴进去

‍

嵌入块

* 指的是直接在当前文档页上，显示其他文档或其他块的内容
* 最大好处是可以直接修改块内容，并且改动的内容**会同步**到原文和所有引用该块的地方
* 输入方法：按两个大括号 `{{`​​​

‍

‍

‍

#### 数据库

[数据库探索](https://mp.weixin.qq.com/s?__biz=MzIyMjIwOTQwMg==&mid=2650000465&idx=1&sn=6f0d070f9cec4f90d33fbf6f2ab53d29&chksm=f0379844c7401152d6c055b4b031e2ad45455a62fd539ff0512beac28c9f1c24ac74bc9d0237&token=389058264&lang=zh_CN&utm_source=ld246.com#rd)

‍

‍

‍

#### 查询语法(SQL)

‍

全局搜索 <kbd>Ctrl+P</kbd>​ 支持通过查询语法（Query Syntax）进行高级搜索，以便实现一些逻辑操作，比如包含关键字 `foo`​ 并且不包含关键字 `bar`​ 的查询语法为 `foo NOT bar`​. 

在使用查询语法之前，我们先大致了解一下该语法的构成：

* 字符串（String）：由字母、数字等构成
* 短语（Phrase）：由字符串构成
* 查询（Query）：由短语构成，多个查询可通过 `AND`​、`OR`​ 和 `NOT`​ 组合为新的查询

‍

‍

##### 字符串

字符串可由两种方式指定：

* 通过英文双引号 " 包裹起来的字符. 其中如果需要使用 " 本身，则可通过 SQL 风格转义（再加一个"），例如 "foo""bar""" 将搜索命中 foo"bar"
* 由非 AND、OR 和 NOT 字符组成，并且这些字符必须是：

  * 所有非 ASCII 字符，或者
  * 属于 52 个大小写英文字符（A-Za-z），或者
  * 属于 10 个 ASCII 数字字符（0-9），或者
  * 是下划线 _，或者
  * 是替换符（ASCII 26）

对于非上述的其他字符构成的字符串，必须使用 " 包裹起来，比如包含了 -、* 等符号的字符串. 

‍

##### 短语

短语由字符串构成，可由 + 进行连接. 一个短语是由一些记号（Token）有序构成，这些记号由用户的输入文本通过分词器处理得到. 思源使用的分词器为了让中文搜索好用（支持单字搜索），所以实现方式是按照字分词的，也就是说每个汉字或者英文字母都会被拆分为一个记号. 这对 + 连接会产生一些影响，所以如果不确定的话，建议不要使用 + 组合多个短语. 

‍

##### 查询

查询由多个短语构成，可通过操作符 AND、OR 和 NOT 组合为新的查询. 

|操作符|功能|
| --------| -------------------------------|
||query1 和 query2 同时匹配|
||query1 或者 query2 匹配|
||query1 匹配同时 query2 不匹配|

使用英文圆括号 () 可以组合查询的优先级，例如：

```sql
-- 匹配包含 "one" 或者 "two" 的块，不匹配包含 "three" 的块
'one OR two NOT three'

-- 匹配包含 "one" 或者包含 "two" 且不包含 "three" 的块
'one OR (two NOT three)'
```

使用空格分隔的多个短语默认使用 AND 连接，比如：

```sql
'one two three'         -- 'one AND two AND three'
'three "one two"'       -- 'three AND "one two"'
'one OR two three'      -- 'one OR two AND three'

'(one OR two) three'    -- 语法错误！
'func(one two)'         -- 语法错误！
```

‍

#### 服务器搭建

‍

思源也可以自己搭建, 也是self-host的

‍

‍

‍

‍

## 安全维护

‍

### Tips

‍

* 定期备份数据，参考 321 备份原则（至少 3 个副本、2 种介质和 1 个异地存储）
* 云端图床功能可能导致被封号(任何图床)
* 绝对静止按下所谓HTML外装的提交按钮, 直接死机!
* 可能部分代码块被错误折叠, 因此依靠折叠进行备注管理是错误的, 还是使用备注或者引用吧
* 在执行放大缩小的操作时,右上角的是控制全局字体(谨慎使用),滚轮的是控制工作区,但是图片仍然保持绝对大小(建议全部用文字代替提高兼容性)
* ==行级代码==  插入过多可能会导致崩溃; 里外都有光标插入,容易导致排版失误,建议不要滥用
* ==保持已记载的内容==  可以更舒服的完成长篇资源的复制 但是可能导致性能雪崩
* 复制一般文本到有格式文本的旁边会导致格式的扩大化, 注意
* 展开功能在导出和复制时候极其容易出错. 例如只复制了一个标题出去, 里面的内容都没了, 而且撤回还无法还原. 因此不建议过多展开收起
* 导出为MD的时候有许多特性无法保存, 因此以后还是尽可能的遵循MD的语法比较好, 双链什么自带的就算了
* 删除文档而未提前删除文档书签导致找不到块
* 有时候工作空间里会出现所谓"undefined"文件夹, 打开里面是没用的图片, 直接连同这个文件夹删除即可.
* 大幅度框选, 结果把上面界面内的元素全部框选了, 最后全部删除还要卡一会儿的问题了, 真是太搞了, 一定要小心, 甚至还需要撤销好几次才能还原之前的状态!
* 大量"删除标题以及下方块"时候会当前页面空白, 需要列表中手动选择后方的块来进行判断
* 同步尽量关闭生成错误文档(导致大量重复), 尽量一次只在一台机子上操作, 先下载, 操作完毕立刻上传; 另一台先下载, 然后上传. 不要让工作区间同时存在两个有新更改的文档

‍

‍

### 安保功能

‍

#### 同步指南

[思源笔记同步指南 ( 更新 2.10.5 版本适用） - tianyunperfect 的回帖 - 链滴 (ld246.com)](https://ld246.com/article/1683395267749/comment/1689041060759)

‍

**数据冲突，已为你生成冲突文件**

这个问题常见于同时打开多端同步，在极短时间(个人预估 10 秒内）两端都在同步导致，因各端与服务器的交互时间不一致，会发生不可预期的你覆盖我还是我覆盖你的行为. 根据思源的同步原理，当发生冲突时，一般以本地为准，把云端的数据生成冲突文件在文档树中. 

应对方案：

① 本地的数据是以前的，新的没同步下来

这个也有两种情况：

* 云端同步已启用**同步时生成冲突文档**选项

  * 如果启用了选项，那么在对应文档的文档树上方，会有一个同名文档，但有括号备注 con'flict 的文件，里面则是云端的数据，可按需移动数据或增减文件.
* 没有启用生成冲突文档选项

  * 如果没有启用，那么可以点击左上角工作空间进入**数据历史（alt+h）** ，查看**文件历史**，找到对应时间的历史记录按需操作.   
    ​![image](https://b3logfile.com/file/2023/05/siyuan/1630025891949/assets/image-20230507010321-0wvsz8g.png?imageView2/2/interlace/1/format/webp)669 x 602326 x 210

② 冲突的文档太多，一个个恢复太困难

在思源 2.8.6 版本，开发者实现了按需下载云端快照的功能，这个功能可以让我们非常方便的恢复其他端的数据到本机. 

* 点击左上角工作空间进入**数据历史**，点击第三个**数据快照，选择云端快照，可以看到左边会列出各个设备名对应的同步产生的云端快照，根据时间判断一下需要恢复过去的快照，点击最右方的下载按钮下载到本地快照. **   
  ​![image](https://b3logfile.com/file/2023/05/siyuan/1630025891949/assets/image-20230507010652-8cgzdji.png?imageView2/2/interlace/1/format/webp)701 x 1192320 x 395
* 点击回到本地快照，选中前面下载过来的云端快照（注意比对 7 位代码），点击右边的回滚即可恢复该快照  
  ​![image](https://b3logfile.com/file/2023/05/siyuan/1630025891949/assets/image-20230507010913-wvzm7gu.png?imageView2/2/interlace/1/format/webp)701 x 682330 x 225

‍

**问题 5 云端存储服务提供商网络连通性异常，请检查网络配置**

几个方向可以排查：

① 建议先看一下电脑时间是不是和实际北京时间不一致. 新版的同步会校验本地时间和云端时间，如果两个时间相差过大，会出现这个问题. 

② 如果是用的第三方同步，建议检查配置，比如 http 和 https，如果是 s 需要服务器有证书. 

③ 网管 ban 了对应服务提供商的地址. 注意看思源日志文件里的云端地址是否正常，如果变成了 127 的 ip 可能是因为 ddns 出了问题. 

④ 本机使用了代理，思源无法直接通过全局代理使用，要么关掉代理要么就是去设置-关于里设置一下. 

⑤ 本机可能有多个网卡，思源走了另外的内网网卡. 

‍

#### **查找丢失块**

新建嵌入块，使用以下代码定位

```java
select *
from blocks
where id in (
select block_id
from refs
where not def_block_id in (
select id
from blocks
)
)
```

‍

#### 文件历史

‍

* 每隔 10 分钟会对这 10 分钟内更新过的文档生成历史（间隔时间可通过 <kbd>设置</kbd>​ - <kbd>编辑器</kbd>​ - <kbd>历史生成间隔</kbd>​ 进行调整），历史文件夹后缀为 `-update`​
* 云端同步时，本地被云端覆盖的数据会生成历史，历史文件夹后缀为 `-sync`​​
* 手动删除笔记本、文档和资源文件时会生成历史，历史文件夹后缀为 `-delete`​​
* 使用清理未引用资源时会生成历史，历史文件夹后缀为 `-clean`​​​
* 使用优化排版时会生成历史，历史文件夹后缀为 `-format`​​​
* 使用 <kbd>搜索替换</kbd>​​ 时会生成历史，历史文件夹后缀为 `-replace`​​

‍

**通过文件历史回滚**

在数据历史界面左侧时间列表栏中，每一条历史记录右侧都有一个回滚按钮，点击以后将弹出确认对话框，如果确认回滚的话将使用文件历史覆盖现有文件. 

如果有非常多的文件需要回滚，建议手动在文件系统上复制. 历史文件夹的内部结构和 data 内部结构一致，比如：

* 笔记本删除：`2022-05-01-091021-delete/20210808180117-czj9bvb/`​，即 `历史生成日期-{操作}/{笔记本 ID}/`​
* 文档删除：`2022-05-01-091209-delete/20210808180117-czj9bvb/20200812220555-lj3enxa.sy`​，即 `历史生成日期-{操作}/{笔记本 ID}/{文档路径}`​
* 资源文件清理：`2022-05-01-095621-clean/assets/image-20220501091157-qccp87e.png`​，即 `历史生成日期-{操作}/assets/{资源文件名}`​

‍

手动回滚操作步骤

1. 退出思源，然后全量复制备份一下整个工作空间，避免后续误操作导致数据丢失
2. 进入 `工作空间/history/`​​ 文件夹，将 `历史生成日期-{操作}`​​ 文件夹下的数据直接复制到 data 文件夹进行覆盖
3. 启动思源后手动执行重建索引

‍

‍

#### 导入导出

‍

导入DATA规则

* 重复的文件进行覆盖
* 不存在的文件进行新增
* 已有的文件不做任何处理

‍

原则

* 从文档树导出的包只能从文档树导入
* 从 设置 - 导出 中导出的 Data 只能从 导入 Data 导入

前者是在文档树上批量导出导入，后者是整个工作空间数据导出导入，**两种数据包不能混用.**

‍

‍

#### 工作空间

‍

工作空间用于保存数据、历史、配置和运行时所需要的文件. 

* 不同工作空间通过文件系统文件夹相互隔离
* 一个工作空间只能被一个内核进程伺服
* 当空间实在是过大时, 尝试使用多个工作空间保存内容(新工作空间需要先导入自原始空间一次)

‍

‍

##### 切换工作空间

* 桌面端可以在顶栏左侧下拉菜单中打开多个工作空间

  如果你的多个工作空间需要经常启动，可以考虑为每个工作空间创建不同的启动入口并指定启动参数 `--workspace=工作空间绝对路径`​. 比如 Windows 系统上可以复制多个快捷方式，并在每个快捷方式 - 属性 - 目标后跟随工作空间路径参数，例如 `--workspace=F:\SiYuan`​. 除此以外，还可以通过 `--port=12345`​ 来指定内核监听的端口.

‍

‍

##### 文件系统结构

文件系统上工作空间下的结构：

* ​`conf`​ 用于保存工作空间配置
* ​`corrupted`​ 用于保存已经损坏的数据文件
* ​`data`​ 保存数据
* ​`history`​ 用于保存文件历史
* ​`repo`​ 用于保存数据仓库数据
* ​`temp`​ 用于保存运行时所需的临时文件
* ​`.lock`​ 内核进程启动后会创建该文件，用于锁定工作空间

‍

‍

‍

## 性能优化

‍

### Tips

‍

* 开虚拟引用会占用非常大
* 写笔记的时候注意多分块，让动态加载的负载均衡. 同时避免巨大列表
* 如不常用的内容放入归档笔记本，然后关闭笔记可以显著地减少内存的占用
* 避免使用过多软换行，虽然不使用软换行会增加块数，但是少使用软换行可以减小段落块大小避免编辑器卡顿
* 调小 <kbd>动态加载块数</kbd>​​​，特别是对于公式块、代码块或图表块较多的使用场景
* 通过 <kbd>聚焦</kbd>​​ 减少元素
* 2个月就应当清理一下temp文件夹的内容, 全部删除都可以(确实稍微快了一点)

‍

‍

‍

## 同步增强

‍

> 搭建流程见个人Blog, 这里记录配置信息

‍

‍

### 七牛云

‍

‍

#### 云端

浙江1- siyuanhelper

> 没有版本管理和生命周期, 防止扣费

区域简称 Region ID	访问 Endpoint

|存储区域|区域简称 Region ID|访问 Endpoint|协议|
| -----------| --------------------| --------------------------| -------------|
|华东-浙江|cn-east-1|s3.cn-east-1.qiniucs.com|HTTP，HTTPS|

|华北-河北|cn-north-1|s3.cn-north-1.qiniucs.com|
| -----------| ------------| ---------------------------|

‍

**Bucket URL**

```java
https://siyuanhelper.sh1a.qingstor.com
```

‍

‍

#### 思源

‍

##### **Endpoint**

**Endpoint** 输入访问地址（格式大致为：`https://s3.<zone-id>.qingstor.com/`​）

要修改`Bucket URL`​, 粘贴在 **Endpoint** 中，并将存储桶的名称部分（ `<bucket-name>`​ ）改为 `s3`​ . 比如我设置的存储桶名称是：`siyuan-12345678901`​ ，那么就将 `https://siyuan-12345678901.gd2.qingstor.com`​ 改为 `https://s3.gd2.qingstor.com/`​ . （注意链接中字母是小写，不要错了）

```
s3.cn-east-1.qiniucs.com
```

‍

##### APIkey

[七牛云 - 密钥管理 (qiniu.com)](https://portal.qiniu.com/developer/user/key?utm_source=ld246.com)

**Acess Key**

```java
jCn9EfsbrtWMk2iIjaZqWlzftnRAKf409nNflWHy
```

**Secret Key**

```java
OyCkvMcEqtGFFs3g-7qTfg9bsqUNJu4qSAsnslAF
```

‍

‍

##### **Bucket**

存储桶名称

```java
siyuanhelper
```

‍

##### **Region**

输入区域代码，按照上图或官方文档的 `Region ID`​ 列来填写，没有的话应该可以不填，但我还是按照自己的区域输入了 `gd2`​

```java
cn-east-1
```

‍

##### 余下

**Addressing Path-style**

‍

**TLS Verify**

‍

**Timeout (s)**  默认为 30 。这个是超时时间，在数据量大或者网速慢的情况下需要改大一些

‍

点击 **云端同步目录** 右侧 `设置`​ ，可见账户下所有 S3 存储桶，点击目标存储桶即可

‍

‍

秘钥字符串

> ‍

‍
