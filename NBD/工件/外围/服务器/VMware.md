--狠狠拷打恶意软件

‍

VMware是业界最好用的虚拟机软件之一(大嘘)

‍

### Header

创建本地Linux虚拟机, 已经被我淘汰, 接下来全盘使用云服务器

‍

‍

## 特点

‍

### 网络模式类型

‍

#### 桥接

在网络网卡上安装了一个桥接协议，让这块网卡处于混杂模式，可以同时连接多个网络的做法. 

桥接下，类似于把物理主机虚拟为一个交换机，所有桥接设置的虚拟机连接到这个交换机的一个接口上，物理主机也同样放在这个交换机当中，所以所有桥接下网卡与网卡都是交换模式的，相互可以访问而不干扰. 

---

桥接模式，可以这样进行理解

> 它是通过主机网卡，假设了一条桥，直接连入到网络中了，因此，它使得虚拟机能被分配到一个网络中独立的IP，所有网络功能完全和在网络中的真实机器一样。
>
> 桥接模式下的虚拟机，我们把它认为是真实计算机就行了~

**虚拟机和主机**：可以相互访问，因为虚拟机在真实网络段中有独立IP，主机与虚拟机处于同一网络段中，彼此可以通过各自IP相互访问

**虚拟机与其它主机**：可以相互访问，同样因为虚拟机在真实网络端中有独立IP，虚拟机与所有网络其它主机处于同一个网络段中，彼此可以通过各自IP相互访问

**虚拟机与虚拟机**： 同样可以相互转换，原因同上

桥接模式下，虚拟机就像一台真正的计算机一样，直接连接到实际网络，与宿主机没有任何联系

‍

#### Host-only

（仅与主机通信）
虚拟机使用VMnet1网卡与主机单独组网,主机对于虚拟机相当于路由器

主机模式：这是一种比较复杂的模式，需要有比较扎实的网络基础知识才能玩转。可以说前面几种模式所实现的功能，在这个模式下，通过虚拟机及网卡的设置都可以被实现。

我们可以理解为Guest在主机中模拟出一张专供虚拟机使用的网卡，所有的虚拟机都是连接到该网卡上的，我们可以通过设置这张网卡来实现上网以及其他功能

‍

‍

#### NAT

**NAT**：Network Address Translation，网络地址转换

虚拟机使用VMnet8网卡与主机单独组网,主机对于虚拟机相当于路由器，VMnet8网卡通过NAT地址转换协议与物理机网卡通信

‍

在NAT模式下，宿主计算机相当于一台开启了DHCP功能的路由器，而虚拟机是内网中的一台真实主机，通过路由器(宿主计算机) DHCP动态获得网络参数，因此在NAT模式下，虚拟机可以访问外部网络，反之则不行

使用NAT模式的方便之处在于，我们不需要做任何网络设置，只要宿主机可以连接到外部网络，虚拟机也可以。

**虚拟机与主机**：只能单向访问，虚拟机可以通过网络访问到主机，主机无法通过网络访问到虚拟机

**虚拟机与其它主机**：只能单向访问，虚拟机可以访问到网络中其它主机，其它主机不能通过网络访问到虚拟机

**虚拟机与虚拟机**：VMware NAT模式下，各虚拟机在同一网段下是可以互相访问的

NAT模式下，虚拟机网络连接到宿主机的VMnet8上，此时系统的VMWare NAT Service服务器就充当了路由器的作用，负责将虚拟机发送到VMnet8的包 进行地址转换之后，发到实际的网络上，再将实际网络上返回的包进行地址转换后通过VMnet8发送到虚拟机。VMware DHCP Service 负责为虚拟机提供DHCP服务。

也就是说NAT模式下，虚拟机网卡连接到宿主机的VMnet8的网卡，当VMnet8收到虚拟机发送的数据包时，会吧数据包转发给物理机的网卡。相当于物理网卡不能直接接触虚拟机的数据包，而是接触VMnet8进行处理，实际上VMnet8是NAT模式，自带DHCP功能，能够给虚拟机分配IP地址。

‍

‍

### 使用NAT!

桥接模式的配置很简单，但是如果网络环境ip资源很缺少，或者对ip管理比较严格的时候，那么桥接模式就不适用了，因为我们通过上面的理解可以知道，桥接模式就是创建一个和宿主机同一级别的网络环境，它是在网络地址中真实存在的ip地址。

如果我们又想让虚拟机上网，又不想占用真实的IP地址，那么就需要使用NAT模式是最好的选择，NAT模式借助虚拟NAT设备和虚拟DHCP服务器，使得虚拟机可以联网。

‍

### 设置虚拟机快照

在虚拟机安装完成后，最好立刻设置一个快照，这样一旦将来虚拟机出现问题，可以快速恢复

‍

‍

## 教程

‍

windows版本的[网站](https://www.vmware.com/cn/products/workstation-pro/workstation-pro-evaluation.html)

Windows10以上版本操作系统需要下载安装VMware Workstation Pro16及以上版本

‍

‍

### 卸载旧版VMware

如果自己电脑上已经有了低版本的VMware，则需要先卸载，再重新安装. 卸载过程比较麻烦

‍

**控制面板找到程序和功能选项**

找到VMware，进行卸载操作

‍

**VMware的安装目录**

是否有旧数据，一并清理掉

‍

**清理注册表**

首先，按住Windows + R , 在弹出框中输入 "regedit" 调出注册表

进入注册表编辑器 打开**​`HKEY_CURRENT_USER`​**​文件夹，找到**​`Software`​**​文件夹并打开

找到“VMware.Inc”，右键删除

‍

‍

### 安装发行版

‍

Centos7是比较常用的一个Linux发行版本

老外的下载站  新CentOS7iso文件[网址](https://ftp.riken.jp/Linux/centos/7.9.2009/isos/x86_64/)

‍`lua CentoS-7-x86_64-Minimal-2009.iso ‍`​

> 我去, 我原来的要4.1G! 这不狠狠下载!

个人VMware激活许可证

```xml
ZF3R0-FHED2-M80TY-8QYGC-NPKYF
```

‍

‍

### 组装

在网络页面做下面的几件事情

1. 修改主机名为自己喜欢的主机名，不要出现中文和特殊字符，建议用localhost
2. 点击应用
3. 将网络连接打开
4. 点击配置，设置详细网络信息

点击配置按钮后，我们需要把网卡地址改为静态IP，这样可以避免每次启动虚拟机IP都变化. 所有配置照搬你自己截图的网络信息填写

上图中的四个信息参考之前的**以太网(ens33)网卡**的截图

‍

‍

## 静态配置

‍

### 宿主机VMnet8网卡

因为NAT模式需要借助宿主机的Vmnet8网卡进行虚拟机与主机之间的通信的，因此我们需要首先找到宿主机上的VMnet8网卡

右键属性，找到IPv4协议，然后选择 **自动获取 IP地址**

‍

### 虚拟网络编辑器

到VMware中，点击 编辑 -> 虚拟网络编辑器，然后选择 还原默认值

‍

在还原后，我们在上面能够看到有三种模式了，这里我们主要是 操作 NAT模式. 勾选左下角所有选项框

‍

### NAT设置

设置网关IP为： 192.168.XXX.254 【这里需要记住这个值，以后会用到】，然后保存

‍

‍

### DHCP设置

能看到我们的起始ip地址 和 结束ip地址，也就是后面我们在设置固定ip地址时，必须在这个范围内

‍

### 设置CentOS网络连接方式

找到网络适配器，选择NAT模式

‍

### 设置网络

然后我们就可以启动我们的CentOS系统进行网络配置了

```bash
# 编辑网络配置文件
vim /etc/sysconfig/network-scripts/ifcfg-ens33
```

然后在文件中，加入如下内容

```bash
TYPE=Ethernet
PROXY_METHOD=none
BROWSER_ONLY=no
BOOTPROTO=static
DEFROUTE=yes
IPV4_FAILURE_FATAL=no
IPV6INIT=yes
IPV6_AUTOCONF=yes
IPV6_DEFROUTE=yes
IPV6_FAILURE_FATAL=no
IPV6_ADDR_GEN_MODE=stable-privacy
NAME=ens33
UUID=1f6d2414-12b7-40ef-8fb1-d2e6db9c739b
DEVICE=ens33
ONBOOT=yes
IPADDR=192.168.13.130
NETMASK=255.255.255.0
GATEWAY=192.168.13.254
DNS1=223.5.5.5
```

这里需要注意的几个点就是下面几个参数

```bash
#设置静态模式
BOOTPROTO=static
ONBOOT=yes
#ip地址【DHCP中的范围内的】
IPADDR=192.168.13.130 
#子网掩码
NETMASK=255.255.255.0
#网关【刚刚我们在NAT设置中配置的】
GATEWAY=192.168.13.254
DNS1=223.5.5.5
```

配置完成后，我们就重启网络即可

```bash
#重启网卡
service network restart
```

‍

### 测试

下面我们通过 ping命令，查看是否能够正常访问网络

```bash
ping www.baidu.com
```

‍

### 排错

系统宿主机是不是两个服务被禁用了, 要开起来.

‍

‍

## 建议

‍

‍

搭建时候选择不要从镜像直接装(出问题变成预制菜), 自己**配完了再载入**

同时也不要选择没用图形化的界面, 也不要最小安装, 不然bug多到怀疑人生

余下见个人Linux装配记录

‍
